---
layout: post
title: "Generating images in different styles with neural networks"
date: 2015-11-16 15:35:00
categories:
---

Neural networks have been getting deeper and deeper, leading to a range of techniques to try to understand how they work. I wrote about some experiments with one of these, [Deep Dream](http://razi.xyz/2015/09/23/deep-dreaming-with-google.html); this post will introduce another called [Neural Style](http://arxiv.org/abs/1508.06576), introduced by Leon Gatys, Alexander Ecker, and Matthias Bethge of Bethge Lab. 

**TL;DR:** Neural Style allows us to apply the style of one image to another. Check out some examples below.

By extracting information from the representations of an image constructed by a neural network, Neural Style can generate an image that contains the content of one in the style of another. How does it do this? Neural networks work by successively transforming their input data; by extracting the data as it passes from layer to layer we can construct a hierarchical representation of the input image. This representation encodes information about the input image, including vector representations of the [texture](http://arxiv.org/abs/1505.07376) and content of the image. For a more technical explanation of how the Neural Style algorithm works, check out [my slides](https://docs.google.com/presentation/d/1a1D9_V9RMaW1VZZ0utEqsY-iS6oBBtO8oBotTlzSVRw/view) or [the original paper](http://arxiv.org/abs/1508.06576).



**Input image:**
![Image of Swarthmore from AP](/assets/ap.jpg)

**Guernica, Picasso:**
![Guernica, Pablo Picasso](/assets/guernica.jpg)


**Generating our picture of Swarthmore in the style of Guernica:**
![Generating Swarthmore in the style of Guernica](/assets/guernica.gif)

Neural Style starts with random noise and then slowly tweaks the image until it matches the style and content of the input images as closely as it can (by minimizing our loss function). 


Below you can find the same image of Swarthmore generated in a couple different styles:

![Swarthmore in the style of Paul Gauguin](/assets/gauguin.png)

![Swarthmore in the style of Jasper Johns](/assets/jasper.png)

![Swarthmore in the style of Wassily Kandinsky](/assets/kandinsky.png)


Inspired by these results, I decided to try generating new artworks by combining works of existing artists. After a number of experiments, I settled on Keith Haring, an American artist known for his vivid styles. I combined one of his black-and-white works with some of his vivid textural patterns to see what he might've produced. The results are below, with the original content image on the left and the styles applied to that image running along the top. 

![Keith Haring style combinations](/assets/haring_demo.png)

If you find these images interesting, you'll be glad to know that they're not too computationally intensive; on Amazon's g2.2xlarge instances, generating one image takes about 15 minutes.

Other people have also experimented with Neural Style. Below is one of my favorite examples, applying numerous styles to *Alice and Wonderland*, generated by Gene Kogan:

<iframe src="https://player.vimeo.com/video/139123754" width="800" height="400" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>



